```{r}
rm(list=ls())
cat("\014") #Command to clear console 


install.packages("remotes")
library(remotes)  
remotes::install_gitlab("BAQ6370/sozoekds", host="gitlab.rrz.uni-hamburg.de")
library(sozoekds) 
library(tidyverse)
library(dplyr)
airbnb_data <- airbnbsmall
N=nrow(airbnb_data) 
N
colnames(airbnb_data) # variables
str(airbnb_data) # variable types 
summary(airbnb_data) # summary of all variables in the data set
summary(airbnb_data$price) # summary of only the price variable
view(airbnb_data) # provides further descriptive information (e.g. nr of missings)
mod1 = lm(price~. ,data=airbnb_data) 
summary(mod1) 
in_predictions <- predict(mod1, airbnb_data) 
#Solution
in_error <- (in_predictions-airbnb_data$price)
sqrt(mean(in_error^2)) 
# create a dummy variable for "high_rating"
airbnb_data <- airbnb_data %>%
  mutate(# adds the variable "high_rating" to the "airbnb_data" dataset
    high_rating = ifelse(airbnb_data$n_review_scores_rating>94, 1, 0)  
  ) 
#My Solution
airbnb_data$high_rating = ifelse(airbnb_data$n_review_scores_rating>94, 1, 0)

view(airbnb_data)
mod2 = lm(airbnb_data$high_rating~. ,data = airbnb_data)
summary(mod2)
MSE <-  function(y,y_head){
  MSE = mean((y-y_head)^2) #MSE Formel 
  return(MSE)
}
pred_mod2 = predict(mod2, airbnb_data)
mse_mod2 = MSE(airbnb_data$high_rating, pred_mod2) #MSE Formel angewendet 
mse_mod2

```
